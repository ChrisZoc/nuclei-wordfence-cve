id: CVE-2021-34630

info:
  name: "GTranslate Pro and GTranslate Enterprise <= 2.8.64 - Reflected Cross-Site Scripting"
  author: topscoder
  severity: Medium
  description: "In the Pro and Enterprise versions of GTranslate < 2.8.65, the gtranslate_request_uri_var function runs at the top of all pages and echoes out the contents of $_SERVER['REQUEST_URI']. Although this uses addslashes, and most modern browsers automatically URLencode requests, this plugin is still vulnerable to Reflected XSS in older browsers such as Internet Explorer 9 or below, or in cases where an attacker is able to modify the request en route between the client and the server, or in cases where the user is using an atypical browsing solution."
  reference:
    - https://plugins.svn.wordpress.org/gtranslate/tags/2.8.64/gtranslate.php
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:L
    cvss-score: 5.8
    cve-id: CVE-2021-34630
  metadata:
    fofa-query: "wp-content/plugins/gtranslate/"
    google-query: inurl:"/wp-content/plugins/gtranslate/"
  tags: cve,wordpress,wp-plugin

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/gtranslate/readme.txt"

    extractors:
      - type: regex
        name: version
        group: 1
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "gtranslate"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 2.8.65')