id: CVE-2021-24481

info:
  name: Any Hostname <= 1.0.6 - Authenticated (Admin+) Stored Cross-Site Scripting
  author: topscoder
  severity: Medium
  description: The Any Hostname WordPress plugin through 1.0.6 does not sanitise or escape its "Allowed hosts" setting, leading to an authenticated stored XSS issue as high privilege users are able to set XSS payloads in it
  reference:
    - https://wpscan.com/vulnerability/a4c352de-9815-4dfe-ac51-65b5bfb37438
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 5.5
    cve-id: CVE-2021-24481
  metadata:
    fofa-query: "wp-content/plugins/any-hostname/"
    google-query: inurl:"/wp-content/plugins/any-hostname/"
  tags: cve,wordpress,wp-plugin

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/any-hostname/readme.txt"

    extractors:
      - type: regex
        name: version
        group: 1
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "any-hostname"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 1.0.6')