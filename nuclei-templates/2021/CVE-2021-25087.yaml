id: CVE-2021-25087

info:
  name: Download Manager <= 3.2.34 - Sensitive Information Disclosure
  author: topscoder
  severity: critical
  description: The Download Manager WordPress plugin before 3.2.35 does not have any authorisation checks in some of the REST API endpoints, allowing unauthenticated attackers to call them, which could lead to sensitive information disclosure, such as posts passwords (fixed in 3.2.24) and files Master Keys (fixed in 3.2.25).
  reference:
    - https://wpscan.com/vulnerability/d7ceafae-65ec-4e05-9ed1-59470771bf07
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2021-25087
  metadata:
    fofa-query: "wp-content/plugins/download-manager/"
    google-query: inurl:"/wp-content/plugins/download-manager/"
  tags:  cve,wordpress,wp-plugin,critical

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/download-manager/readme.txt"

    extractors:
      - type: regex
        name: version
        group: 1
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "download-manager"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 3.2.35')