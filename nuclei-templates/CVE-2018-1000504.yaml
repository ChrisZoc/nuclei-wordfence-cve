id: CVE-2018-1000504

info:
  name: "Redirection <= 2.7.3 - Local File Inclusion"
  author: topscoder
  severity: High
  description: "Redirection version 2.7.3 contains a ACE via file inclusion vulnerability in Pass-through mode that can result in allows admins to execute any PHP file in the filesystem. This attack appear to be exploitable via Attacker must be have access to an admin account on the target site. This vulnerability appears to have been fixed in 2.8."
  reference:
    - https://advisories.dxw.com/advisories/ace-file-inclusion-redirection/
    - https://seclists.org/fulldisclosure/2018/Jun/29
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
    cve-id: CVE-2018-1000504
  metadata:
    fofa-query: "wp-content/plugins/redirection/"
    google-query: inurl:"/wp-content/plugins/redirection/"
  tags: cve,wordpress,wp-plugin

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/redirection/readme.txt"

    extractors:
      - type: regex
        name: version
        internal: true
        group: 1
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "redirection"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 2.7.3')