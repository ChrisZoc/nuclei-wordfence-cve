id: CVE-2022-0837

info:
  name: Appointment and Event Booking Calendar for WordPress â€“ Amelia <= 1.0.47 - Information Disclosure and SMS Spam
  author: topscoder
  severity: Medium
  description: The Amelia WordPress plugin before 1.0.48 does not have proper authorisation when handling Amelia SMS service, allowing any customer to send paid test SMS notification as well as retrieve sensitive information about the admin, such as the email, account balance and payment history. A malicious actor can abuse this vulnerability to drain out the account balance by keep sending SMS notification.
  reference:
    - https://wpscan.com/vulnerability/0882e5c0-f319-4994-9346-aa18438fda6a
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 6.4
    cve-id: CVE-2022-0837
  metadata:
    fofa-query: "wp-content/plugins/ameliabooking/"
    google-query: inurl:"/wp-content/plugins/ameliabooking/"
  tags: cve,wordpress,wp-plugin

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/ameliabooking/readme.txt"

    extractors:
      - type: regex
        name: version
        internal: true
        group: 1
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "ameliabooking"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 1.0.48')