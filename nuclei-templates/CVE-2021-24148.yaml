id: CVE-2021-24148

info:
  name: "MStore API <= 3.1.9 - Authentication Bypass"
  author: topscoder
  severity: Critical
  description: "A business logic issue in the MStore API WordPress plugin, versions before 3.2.0, had an authentication bypass with Sign In With Apple allowing unauthenticated users to recover an authentication cookie with only an email address."
  reference:
    - https://wpscan.com/vulnerability/bf5ddc43-974d-41fa-8276-c1a27d3cc882
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-24148
  metadata:
    fofa-query: "wp-content/plugins/mstore-api/"
    google-query: inurl:"/wp-content/plugins/mstore-api/"
  tags: cve,wordpress,wp-plugin

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/mstore-api/readme.txt"

    extractors:
      - type: regex
        name: version
        internal: true
        group: 1
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "mstore-api"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 3.1.9')