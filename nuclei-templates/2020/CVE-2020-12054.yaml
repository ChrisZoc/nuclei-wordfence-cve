id: CVE-2020-12054

info:
  name: "Catch Breadcrumb <= 1.5.4 - Reflected Cross-Site Scripting"
  author: topscoder
  severity: Medium
  description: "The Catch Breadcrumb plugin before 1.5.4 for WordPress allows Reflected XSS via the s parameter (a search query). Also affected are 16 themes (if the plugin is enabled) by the same author: Alchemist and Alchemist PRO, Izabel and Izabel PRO, Chique and Chique PRO, Clean Enterprise and Clean Enterprise PRO, Bold Photography PRO, Intuitive PRO, Devotepress PRO, Clean Blocks PRO, Foodoholic PRO, Catch Mag PRO, Catch Wedding PRO, and Higher Education PRO."
  reference:
    - https://wpvulndb.com/vulnerabilities/10184
    - https://cxsecurity.com/issue/WLB-2020040144
    - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2290480%40catch-breadcrumb&new=2290480%40catch-breadcrumb&sfp_email=&sfph_mail=
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-12054
  metadata:
    fofa-query: "wp-content/plugins/catch-breadcrumb/"
    google-query: inurl:"/wp-content/plugins/catch-breadcrumb/"
    shodan-query: 'vuln:CVE-2020-12054'
  tags: cve,wordpress,wp-plugin

requests:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/catch-breadcrumb/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "catch-breadcrumb"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 1.5.5')