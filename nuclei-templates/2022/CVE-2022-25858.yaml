id: CVE-2022-25858

info:
  name: terser (JS Package) < 5.14.2 - Denial of Service
  author: topscoder
  severity: Low
  description: The package terser before 4.8.1, from 5.0.0 and before 5.14.2 are vulnerable to Regular Expression Denial of Service (ReDoS) due to insecure usage of regular expressions. Some WordPress plugins and themes use this dependency, however, are not vulnerable to exploitation.
  reference:
    - https://security.snyk.io/vuln/SNYK-JS-TERSER-2806366
    - https://snyk.io/vuln/SNYK-JAVA-ORGWEBJARSNPM-2949722
    - https://github.com/terser/terser/commit/a4da7349fdc92c05094f41d33d06d8cd4e90e76b
    - https://github.com/terser/terser/commit/d8cc5691be980d663c29cc4d5ce67e852d597012
    - https://github.com/terser/terser/blob/master/lib/compress/evaluate.js%23L135
    - https://security.snyk.io/package/npm/terser/5.13.1
    - https://nvd.nist.gov/vuln/detail/CVE-2022-25858
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L
    cvss-score: 3.7
    cve-id: CVE-2022-25858
  metadata:
    fofa-query: "wp-content/plugins/elasticpress/"
    google-query: inurl:"/wp-content/plugins/elasticpress/"
  tags: cve,wordpress,wp-plugin

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/elasticpress/readme.txt"

    extractors:
      - type: regex
        name: version
        group: 1
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "elasticpress"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 4.2.2')