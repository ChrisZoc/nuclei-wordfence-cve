id: CVE-2022-2594

info:
  name: Advanced Custom Fields <= 5.12.2 - File Upload
  author: topscoder
  severity: Medium
  description: The Advanced Custom Fields plugin for WordPress has a file upload vulnerability in versions up to, and including, 5.12.2. This allows users without the upload_files capability, such as contributors, or unauthenticated users in cases where a frontend form is added to the site, to upload allowed file types. The upload is handled by WordPress so file type and extension checks still occur, though this could potentially be used by high-privileged users in certain locked-down configurations to bypass other security mechanisms and upload dangerous file types.
  reference:
    - https://wordpress.org/plugins/advanced-custom-fields/#developers
    - https://patchstack.com/database/vulnerability/advanced-custom-fields-pro-/wordpress-advanced-custom-fields-pro-premium-plugin-5-12-2-unauthenticated-file-upload-vulnerability
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 4.3
    cve-id: CVE-2022-2594
  metadata:
    fofa-query: "wp-content/plugins/advanced-custom-fields/"
    google-query: inurl:"/wp-content/plugins/advanced-custom-fields/"
  tags: cve,wordpress,wp-plugin

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/advanced-custom-fields/readme.txt"

    extractors:
      - type: regex
        name: version
        internal: true
        group: 1
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "advanced-custom-fields"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 5.12.2')