id: CVE-2022-45842

info:
  name: "WP ULike <= 4.6.4 - Race Condition"
  author: topscoder
  severity: Medium
  description: "The WP ULike plugin for WordPress is vulnerable to Race Condition in versions up to, and including, 4.6.4. This can lead to unpredictable post rating changes when certain conditions are met."
  reference:
    - https://patchstack.com/database/vulnerability/wp-ulike/wordpress-wp-ulike-plugin-4-6-3-race-condition-vulnerability
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 4.3
    cve-id: CVE-2022-45842
  metadata:
    fofa-query: "wp-content/plugins/wp-ulike/"
    google-query: inurl:"/wp-content/plugins/wp-ulike/"
  tags: cve,wordpress,wp-plugin

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/wp-ulike/readme.txt"

    extractors:
      - type: regex
        name: version
        group: 1
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "wp-ulike"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 4.6.4')