id: CVE-2022-2071

info:
  name: "Name Directory <= 1.25.3 - Cross-Site Request Forgery"
  author: topscoder
  severity: High
  description: "The Name Directory plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 1.25.3. This is due to missing or incorrect nonce validation when editing, deleting or naming directories. This makes it possible for unauthenticated attackers to trigger the above actions via forged request granted they can trick a site administrator into performing an action such as clicking on a link."
  reference:
    - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2749036%40name-directory%2Ftrunk&old=2720174%40name-directory%2Ftrunk&sfp_email=&sfph_mail=
    - https://patchstack.com/database/vulnerability/name-directory-/wordpress-name-directory-plugin-1-25-3-multiple-cross-site-request-forgery-csrf-vulnerabilities
    - https://wpscan.com/vulnerability/d3653976-9e0a-4f2b-87f7-26b5e7a74b9d
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2022-2071
  metadata:
    fofa-query: "wp-content/plugins/name-directory/"
    google-query: inurl:"/wp-content/plugins/name-directory/"
  tags: cve,wordpress,wp-plugin

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/name-directory/readme.txt"

    extractors:
      - type: regex
        name: version
        group: 1
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "name-directory"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 1.25.3')