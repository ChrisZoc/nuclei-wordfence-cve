id: CVE-2017-1000226

info:
  name: "Stop User Enumeration <= 1.3.8 - Unauthenticated Username Enumeration"
  author: topscoder
  severity: Medium
  description: "The Stop User Enumeration plugin for WordPress is vulnerable to Username Enumeration in versions up to, and including, 1.3.8 via the due to the REST API. This makes it possible for unauthenticated attackers to generate lists of usernames gathered from vulnerable services."
  reference:
    - https://seclists.org/fulldisclosure/2017/Jan/10
    - https://advisories.dxw.com/advisories/stop-user-enumeration-does-not-stop-user-enumeration/
    - https://wpscan.com/vulnerability/8ae7958c-26e9-4caf-8a8b-cf1d2e6410a0
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2017-1000226
  metadata:
    fofa-query: "wp-content/plugins/stop-user-enumeration/"
    google-query: inurl:"/wp-content/plugins/stop-user-enumeration/"
  tags: cve,wordpress,wp-plugin

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/stop-user-enumeration/readme.txt"

    extractors:
      - type: regex
        name: version
        group: 1
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "stop-user-enumeration"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 1.3.8')